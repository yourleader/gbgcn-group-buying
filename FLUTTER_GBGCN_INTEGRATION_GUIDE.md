# üì± FLUTTER + GBGCN MODEL - INTEGRATION GUIDE
**Gu√≠a completa para integrar el modelo GBGCN en tu app de Flutter**

## üéØ **ARQUITECTURA DE INTEGRACI√ìN**

### **1. FLUJO PRINCIPAL DE USUARIO**
```
üè† Home Screen ‚Üí üß† GBGCN Recommendations ‚Üí üì¶ Product Details ‚Üí üë• Group Buying ‚Üí üí∞ Checkout
```

### **2. PANTALLAS CLAVE CON GBGCN**

#### **üì± A. PANTALLA PRINCIPAL (Home)**
```dart
// Endpoints a usar:
GET /api/v1/recommendations/items  // Recomendaciones principales
GET /api/v1/groups/               // Grupos activos
GET /api/v1/analytics/dashboard   // M√©tricas del usuario
```

**UI Components:**
- **üî• "Recomendaciones para ti"** (cards con score GBGCN)
- **‚ö° "Grupos form√°ndose"** (grupos con alta probabilidad de √©xito)
- **üìä "Tu dashboard"** (m√©tricas personalizadas)

#### **üì± B. PANTALLA DE RECOMENDACIONES**
```dart
class GBGCNRecommendationsScreen extends StatefulWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('üß† Recomendaciones GBGCN')),
      body: Column(
        children: [
          // Filtros inteligentes
          _buildIntelligentFilters(),
          
          // Lista de recomendaciones con scores
          Expanded(
            child: ListView.builder(
              itemBuilder: (context, index) => _buildRecommendationCard(recommendations[index])
            )
          )
        ]
      )
    );
  }
  
  Widget _buildRecommendationCard(ItemRecommendation item) {
    return Card(
      child: ListTile(
        leading: CircleAvatar(
          backgroundColor: _getScoreColor(item.recommendationScore),
          child: Text('${(item.recommendationScore * 100).toInt()}')
        ),
        title: Text(item.title),
        subtitle: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Text('üí∞ Precio estimado: \$${item.predictedPrice}'),
            Text('üìä Prob. √©xito: ${(item.successProbability * 100).toInt()}%'),
            Text('ü§ù Influencia social: ${(item.socialInfluenceScore * 100).toInt()}%'),
          ]
        ),
        trailing: ElevatedButton(
          onPressed: () => _createOrJoinGroup(item),
          child: Text(_getActionText(item))
        )
      )
    );
  }
}
```

#### **üì± C. PANTALLA DE DETALLES DE PRODUCTO**
```dart
// Integraci√≥n GBGCN en detalles
class ProductDetailsScreen extends StatelessWidget {
  Widget build(BuildContext context) {
    return Scaffold(
      body: Column(
        children: [
          // Informaci√≥n del producto
          _buildProductInfo(),
          
          // üß† SECCI√ìN GBGCN
          _buildGBGCNSection(),
          
          // Botones de acci√≥n
          _buildActionButtons()
        ]
      )
    );
  }
  
  Widget _buildGBGCNSection() {
    return Container(
      padding: EdgeInsets.all(16),
      decoration: BoxDecoration(
        color: Colors.blue.shade50,
        borderRadius: BorderRadius.circular(12)
      ),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          Text('üß† An√°lisis GBGCN', style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold)),
          SizedBox(height: 8),
          
          // Score de recomendaci√≥n
          _buildScoreRow('üéØ Score recomendaci√≥n', gbgcnData.recommendationScore),
          _buildScoreRow('üìä Probabilidad √©xito', gbgcnData.successProbability),
          _buildScoreRow('ü§ù Influencia social', gbgcnData.socialInfluence),
          
          SizedBox(height: 12),
          
          // Grupos sugeridos
          Text('üë• Grupos disponibles:', style: TextStyle(fontWeight: FontWeight.w600)),
          ...suggestedGroups.map((group) => _buildGroupSuggestion(group))
        ]
      )
    );
  }
}
```

#### **üì± D. PANTALLA DE CREACI√ìN DE GRUPO**
```dart
class CreateGroupScreen extends StatefulWidget {
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('üöÄ Crear Grupo')),
      body: Form(
        child: Column(
          children: [
            // Campos b√°sicos
            _buildBasicFields(),
            
            // üß† PREDICCIONES GBGCN
            _buildGBGCNPredictions(),
            
            // Configuraci√≥n inteligente
            _buildIntelligentConfiguration(),
            
            ElevatedButton(
              onPressed: _createGroupWithGBGCN,
              child: Text('üöÄ Crear Grupo Inteligente')
            )
          ]
        )
      )
    );
  }
  
  Widget _buildGBGCNPredictions() {
    return FutureBuilder<GroupFormationAnalysis>(
      future: _analyzeGroupFormation(),
      builder: (context, snapshot) {
        if (snapshot.hasData) {
          final analysis = snapshot.data!;
          return Container(
            padding: EdgeInsets.all(16),
            decoration: BoxDecoration(
              color: Colors.green.shade50,
              borderRadius: BorderRadius.circular(12)
            ),
            child: Column(
              children: [
                Text('üß† Predicci√≥n GBGCN', style: TextStyle(fontSize: 16, fontWeight: FontWeight.bold)),
                
                Row(
                  mainAxisAlignment: MainAxisAlignment.spaceAround,
                  children: [
                    _buildPredictionMetric('üìä Prob. √©xito', analysis.successProbability),
                    _buildPredictionMetric('‚è±Ô∏è Tiempo formaci√≥n', '${analysis.estimatedHours}h'),
                    _buildPredictionMetric('üë• Tama√±o √≥ptimo', analysis.optimalSize.toString())
                  ]
                ),
                
                if (analysis.recommendedParticipants.isNotEmpty)
                  Column(
                    children: [
                      SizedBox(height: 12),
                      Text('üí° Usuarios sugeridos:', style: TextStyle(fontWeight: FontWeight.w600)),
                      Wrap(
                        children: analysis.recommendedParticipants.map((user) => 
                          Chip(label: Text(user.username))
                        ).toList()
                      )
                    ]
                  )
              ]
            )
          );
        }
        return CircularProgressIndicator();
      }
    );
  }
}
```

## üîó **ENDPOINTS CLAVE PARA FLUTTER**

### **1. RECOMENDACIONES (Uso frecuente)**
```dart
class GBGCNApiService {
  final String baseUrl = 'http://your-api.com/api/v1';
  
  // üéØ Obtener recomendaciones principales
  Future<List<ItemRecommendation>> getRecommendations({
    int limit = 10,
    bool includeSocialInfluence = true,
    double minSuccessProbability = 0.1
  }) async {
    final response = await dio.get(
      '$baseUrl/recommendations/items',
      queryParameters: {
        'limit': limit,
        'include_social_influence': includeSocialInfluence,
        'min_success_probability': minSuccessProbability
      },
      options: Options(headers: {'Authorization': 'Bearer $token'})
    );
    
    return (response.data as List)
        .map((item) => ItemRecommendation.fromJson(item))
        .toList();
  }
  
  // üë• Obtener grupos recomendados para unirse
  Future<List<GroupRecommendation>> getRecommendedGroups({
    int limit = 10,
    double minSuccessProbability = 0.3
  }) async {
    final response = await dio.get(
      '$baseUrl/recommendations/groups',
      queryParameters: {
        'limit': limit,
        'min_success_probability': minSuccessProbability
      },
      options: Options(headers: {'Authorization': 'Bearer $token'})
    );
    
    return (response.data as List)
        .map((group) => GroupRecommendation.fromJson(group))
        .toList();
  }
  
  // üîç Analizar potencial de formaci√≥n de grupo
  Future<GroupFormationAnalysis> analyzeGroupFormation({
    required String itemId,
    required int targetQuantity,
    List<String> potentialParticipants = const []
  }) async {
    final response = await dio.post(
      '$baseUrl/recommendations/groups/analyze',
      data: {
        'item_id': itemId,
        'target_quantity': targetQuantity,
        'potential_participants': potentialParticipants,
        'max_participants': 20
      },
      options: Options(headers: {'Authorization': 'Bearer $token'})
    );
    
    return GroupFormationAnalysis.fromJson(response.data);
  }
  
  // ü§ù Obtener an√°lisis de influencia social
  Future<SocialInfluenceAnalysis> getSocialInfluenceAnalysis({
    required String userId,
    String? itemId
  }) async {
    final response = await dio.get(
      '$baseUrl/recommendations/social-influence/$userId',
      queryParameters: itemId != null ? {'item_id': itemId} : null,
      options: Options(headers: {'Authorization': 'Bearer $token'})
    );
    
    return SocialInfluenceAnalysis.fromJson(response.data);
  }
}
```

### **2. GESTI√ìN DE GRUPOS**
```dart
// üöÄ Crear grupo con optimizaci√≥n GBGCN
Future<GroupResponse> createGroup(GroupCreateRequest request) async {
  final response = await dio.post(
    '$baseUrl/groups/',
    data: request.toJson(),
    options: Options(headers: {'Authorization': 'Bearer $token'})
  );
  
  return GroupResponse.fromJson(response.data);
}

// üë• Unirse a grupo
Future<void> joinGroup(String groupId, {String? message}) async {
  await dio.post(
    '$baseUrl/groups/$groupId/join',
    data: {'message': message},
    options: Options(headers: {'Authorization': 'Bearer $token'})
  );
}

// üìä Obtener detalles completos del grupo
Future<GroupResponse> getGroupDetails(String groupId) async {
  final response = await dio.get(
    '$baseUrl/groups/$groupId',
    options: Options(headers: {'Authorization': 'Bearer $token'})
  );
  
  return GroupResponse.fromJson(response.data);
}
```

## üé® **UI/UX ESPEC√çFICO PARA GBGCN**

### **1. COLORES Y VISUALIZACI√ìN DE SCORES**
```dart
class GBGCNTheme {
  // Colores para scores
  static Color getScoreColor(double score) {
    if (score >= 0.8) return Colors.green;
    if (score >= 0.6) return Colors.orange;
    if (score >= 0.4) return Colors.blue;
    return Colors.red;
  }
  
  // Iconos para tipos de recomendaci√≥n
  static IconData getRecommendationIcon(String type) {
    switch (type) {
      case 'initiate': return Icons.rocket_launch;
      case 'join': return Icons.group_add;
      default: return Icons.recommend;
    }
  }
}
```

### **2. WIDGETS PERSONALIZADOS**
```dart
class GBGCNScoreWidget extends StatelessWidget {
  final double score;
  final String label;
  
  Widget build(BuildContext context) {
    return Container(
      padding: EdgeInsets.symmetric(horizontal: 12, vertical: 6),
      decoration: BoxDecoration(
        color: GBGCNTheme.getScoreColor(score).withOpacity(0.1),
        borderRadius: BorderRadius.circular(20),
        border: Border.all(color: GBGCNTheme.getScoreColor(score))
      ),
      child: Row(
        mainAxisSize: MainAxisSize.min,
        children: [
          Icon(Icons.psychology, size: 16, color: GBGCNTheme.getScoreColor(score)),
          SizedBox(width: 4),
          Text(
            '$label: ${(score * 100).toInt()}%',
            style: TextStyle(
              color: GBGCNTheme.getScoreColor(score),
              fontWeight: FontWeight.w600,
              fontSize: 12
            )
          )
        ]
      )
    );
  }
}

class GroupSuccessProbabilityIndicator extends StatelessWidget {
  final double probability;
  
  Widget build(BuildContext context) {
    return LinearProgressIndicator(
      value: probability,
      backgroundColor: Colors.grey.shade300,
      valueColor: AlwaysStoppedAnimation<Color>(
        probability > 0.7 ? Colors.green : 
        probability > 0.4 ? Colors.orange : Colors.red
      ),
    );
  }
}
```

## üîÑ **FLUJOS DE USUARIO CLAVE**

### **1. FLUJO DE DESCUBRIMIENTO**
```
üì± App Launch ‚Üí 
üîê Login ‚Üí 
üß† GBGCN carga recomendaciones ‚Üí 
üì¶ Usuario ve productos sugeridos ‚Üí
üéØ Tap en recomendaci√≥n ‚Üí
üìä Ve predicciones GBGCN ‚Üí
üë• Decide crear o unirse a grupo
```

### **2. FLUJO DE CREACI√ìN DE GRUPO**
```
üì¶ Producto seleccionado ‚Üí
üöÄ "Crear Grupo" ‚Üí
üß† GBGCN analiza potencial ‚Üí
üìä Muestra predicciones ‚Üí
‚öôÔ∏è Usuario configura grupo ‚Üí
üí° GBGCN sugiere participantes ‚Üí
‚úÖ Crear grupo optimizado
```

### **3. FLUJO DE UNI√ìN A GRUPO**
```
üë• Ver grupos recomendados ‚Üí
üß† GBGCN muestra compatibilidad ‚Üí
üìä Ver probabilidad de √©xito ‚Üí
ü§ù Ver conexiones sociales ‚Üí
‚úÖ Unirse al grupo
```

## üìä **MODELOS DE DATOS FLUTTER**

```dart
class ItemRecommendation {
  final String itemId;
  final String title;
  final String description;
  final double regularPrice;
  final double predictedDiscount;
  final double successProbability;
  final double socialInfluenceScore;
  final double recommendationScore;
  final String recommendationReason;
  final String recommendationType; // 'initiate' | 'join'
  
  factory ItemRecommendation.fromJson(Map<String, dynamic> json) {
    return ItemRecommendation(
      itemId: json['item_id'],
      title: json['title'],
      description: json['description'],
      regularPrice: json['regular_price'].toDouble(),
      predictedDiscount: json['predicted_discount'].toDouble(),
      successProbability: json['success_probability'].toDouble(),
      socialInfluenceScore: json['social_influence_score'].toDouble(),
      recommendationScore: json['recommendation_score']?.toDouble() ?? 0.0,
      recommendationReason: json['recommendation_reason'] ?? '',
      recommendationType: json['recommendation_type'] ?? 'initiate'
    );
  }
}

class GroupRecommendation {
  final String groupId;
  final String title;
  final String itemId;
  final int currentMembers;
  final int targetSize;
  final double successProbability;
  final double compatibilityScore;
  final int socialConnections;
  final int estimatedCompletionDays;
  
  factory GroupRecommendation.fromJson(Map<String, dynamic> json) {
    return GroupRecommendation(
      groupId: json['group_id'],
      title: json['title'],
      itemId: json['item_id'],
      currentMembers: json['current_members'],
      targetSize: json['target_size'],
      successProbability: json['success_probability'].toDouble(),
      compatibilityScore: json['compatibility_score'].toDouble(),
      socialConnections: json['social_connections'],
      estimatedCompletionDays: json['estimated_completion_days']
    );
  }
}
```

## üöÄ **IMPLEMENTACI√ìN PASO A PASO**

### **FASE 1: Setup B√°sico (Semana 1)**
1. ‚úÖ Configurar HTTP client (dio)
2. ‚úÖ Implementar autenticaci√≥n JWT
3. ‚úÖ Crear modelos de datos GBGCN
4. ‚úÖ Setup navegaci√≥n entre pantallas

### **FASE 2: Recomendaciones (Semana 2)**
1. ‚úÖ Pantalla de recomendaciones principales
2. ‚úÖ Integrar endpoint `/recommendations/items`
3. ‚úÖ UI para mostrar scores GBGCN
4. ‚úÖ Filtros inteligentes

### **FASE 3: Grupos (Semana 3)**
1. ‚úÖ Pantalla de creaci√≥n de grupos
2. ‚úÖ An√°lisis de formaci√≥n de grupos
3. ‚úÖ Pantalla de detalles de grupo
4. ‚úÖ Funcionalidad unirse/salir

### **FASE 4: Optimizaci√≥n (Semana 4)**
1. ‚úÖ Cache de recomendaciones
2. ‚úÖ Push notifications
3. ‚úÖ Analytics y m√©tricas
4. ‚úÖ Testing y optimizaci√≥n

## üí° **BEST PRACTICES**

### **1. PERFORMANCE**
- Cache recomendaciones por 15 minutos
- Lazy loading para listas largas
- Preload datos de grupos sugeridos

### **2. UX**
- Mostrar scores de manera visual (colores, gr√°ficos)
- Explicar por qu√© se recomienda algo
- Feedback inmediato en acciones

### **3. DATOS**
- Sincronizar preferencias del usuario
- Tracking de interacciones para mejorar GBGCN
- Offline support para funciones b√°sicas

## üéØ **M√âTRICAS A TRACKEAR**

```dart
class GBGCNAnalytics {
  // Trackear interacciones con recomendaciones
  void trackRecommendationClick(String itemId, double score) {
    analytics.logEvent('gbgcn_recommendation_click', {
      'item_id': itemId,
      'recommendation_score': score,
      'timestamp': DateTime.now().toIso8601String()
    });
  }
  
  // Trackear creaci√≥n de grupos
  void trackGroupCreation(String groupId, double predictedSuccess) {
    analytics.logEvent('gbgcn_group_created', {
      'group_id': groupId,
      'predicted_success': predictedSuccess,
      'timestamp': DateTime.now().toIso8601String()
    });
  }
  
  // Trackear uni√≥n a grupos
  void trackGroupJoin(String groupId, double compatibilityScore) {
    analytics.logEvent('gbgcn_group_joined', {
      'group_id': groupId,
      'compatibility_score': compatibilityScore,
      'timestamp': DateTime.now().toIso8601String()
    });
  }
}
```

---

## ‚úÖ **RESUMEN EJECUTIVO**

**Tu app de Flutter debe:**

1. **üéØ Mostrar recomendaciones GBGCN prominentemente** en home
2. **üìä Visualizar scores y probabilidades** de manera clara
3. **üöÄ Facilitar creaci√≥n de grupos** con predicciones inteligentes
4. **üë• Sugerir grupos para unirse** basado en compatibilidad
5. **üìà Trackear m√©tricas** para mejorar el modelo
6. **üîÑ Actualizar datos** frecuentemente para mantener relevancia

**El resultado:** Una experiencia de e-commerce revolucionaria donde el AI GBGCN gu√≠a a los usuarios hacia compras grupales exitosas con alta probabilidad de ahorro y satisfacci√≥n. 